version: '3'
services:
  vitis:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        USER_ID: ${USER_ID:-1000}
        GROUP_ID: ${GROUP_ID:-1000}
        USERNAME: makin
    image: vitis-ubuntu20.04
    container_name: vitis-dev
    environment:
      - DISPLAY=${DISPLAY}
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix
      - $HOME/.Xauthority:/home/makin/.Xauthority:ro
      - ./sys/opt/shared:/opt/shared
      - ./sys/opt/master:/opt/master
      - ./sys/home/makin:/home/makin
    devices:
      - /dev/bus/usb:/dev/bus/usb
    security_opt:
      - label=type:container_runtime_t
    userns_mode: "keep-id"
    working_dir: /home/makin
    command: bash
